% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/random_deg_prediction.R
\name{simulate_random_cor}
\alias{simulate_random_cor}
\title{Monte‑Carlo check of the random‑null correlation}
\usage{
simulate_random_cor(group_sizes, test_idx, n_genes, n_runs, ncores)
}
\arguments{
\item{group_sizes}{Integer vector of cell counts (WT first).}

\item{test_idx}{Integer index of the held‑out KO.}

\item{n_genes}{Number of genes to simulate in every run.}

\item{n_runs}{Number of independent Monte‑Carlo experiments.}

\item{ncores}{Number of CPU cores.}
}
\value{
Numeric vector of length `n_runs` with sample correlations.
}
\description{
Draw full cell × gene matrices from the global‑mean‑centered null model, repeats \code{n_runs} independent experiments,
and returns the vector of sample correlations. The empirical mean should hover around \code{\link{calc_random_cor}}.
}
\examples{
group_sizes <- c(1000, 100, 100)
test_idx <- 3
r0 <- calc_random_cor(group_sizes, test_idx)
emp_r0s <- simulate_random_cor(group_sizes, test_idx, n_genes = 1000, n_runs = 100, ncores = 4)
cat(sprintf("ρ₀ analytic = \%.3f\n", r0))
cat(sprintf("Empirical r = \%.3f  (sd = \%.3f)\n", mean(emp_r0s), sd(emp_r0s)))
}
