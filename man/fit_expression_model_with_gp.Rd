% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/expression_prediction_with_gp.R
\name{fit_expression_model_with_gp}
\alias{fit_expression_model_with_gp}
\title{Fit a Two-Stage Portability Prediction Model}
\usage{
fit_expression_model_with_gp(
  Y,
  group,
  graph,
  source_effects,
  pname,
  pgenes,
  ncores,
  constrain_graph = TRUE,
  alpha = 0.05
)
}
\arguments{
\item{Y}{A numeric matrix of expression data for the target dataset.}

\item{group}{A character vector for the cell groups in Y.}

\item{graph}{An igraph object for the target dataset.}

\item{source_effects}{A named list of data frames with KO effects from source datasets.}

\item{pname}{The name of the hub node (e.g., "PC1").}

\item{pgenes}{A character vector of the signature genes.}

\item{ncores}{The number of cores for parallel computation.}

\item{constrain_graph}{Logical. If TRUE, constrain pgenes to only have pname as a parent before fitting the GRN.}

\item{alpha}{Significance level threshold (F-statistic p-value) to determine if a portability model is considered valid.}
}
\value{
A list containing `B_matrix` and `portability_models`. `portability_models` contains a model for each combination of sources, plus fallback values (`fallback_pname_delta`, `fallback_all_gene_deltas`).
}
\description{
Trains a GRN model and a set of hierarchically inclusive portability models
for all combinations of source datasets.
}
