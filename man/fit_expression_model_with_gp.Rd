% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/expression_prediction_with_gp.R
\name{fit_expression_model_with_gp}
\alias{fit_expression_model_with_gp}
\title{Fit Expression Model and Learn Average SCOPE Effect}
\usage{
fit_expression_model_with_gp(
  Y,
  group,
  graph,
  pname,
  pgenes,
  de_true,
  stat,
  ncores,
  method = c("lm", "ridge", "lasso"),
  pname_to_pgenes_only = TRUE
)
}
\arguments{
\item{Y}{A numeric matrix of expression data (cells x genes), including the hub node.}

\item{group}{A character or factor vector indicating the group for each cell in Y.}

\item{graph}{An igraph object representing the full regulatory structure.}

\item{pname}{A character string for the name of the hub node (e.g., "PC1").}

\item{pgenes}{A character vector of the signature genes regulated by the hub.}

\item{de_true}{A ground truth matrix of DE values (KOs x genes) for the
training set, used to calculate the average SCOPE effect.}

\item{stat}{A long-format data frame of statistics for the training set,
used to identify KOs that trigger the hub.}

\item{ncores}{The number of cores for parallel computation.}

\item{method}{The regression method for the main B matrix. One of 'lm', 'lasso', or 'ridge'.}

\item{pname_to_pgenes_only}{A logical to constrain hub effects to signature genes.}
}
\value{
A list with two components:
  \item{B_matrix}{The main regulatory matrix (sources x targets).}
  \item{scope_mean_effect}{A named vector of the average DE for the hub and
    signature genes, calculated from training KOs that trigger the hub.}
}
\description{
Learns the linear GRN model (B matrix) and calculates the average observed
effect on the SCOPE signature from the provided training data.
}
