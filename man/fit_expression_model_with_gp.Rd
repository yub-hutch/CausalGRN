% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/expression_prediction_with_gp.R
\name{fit_expression_model_with_gp}
\alias{fit_expression_model_with_gp}
\title{Fit a Two-Stage Portability Prediction Model}
\usage{
fit_expression_model_with_gp(
  Y,
  group,
  graph,
  source_effects,
  pname,
  pgenes,
  ncores
)
}
\arguments{
\item{Y}{A numeric matrix of expression data for the target dataset.}

\item{group}{A character vector for the cell groups in Y.}

\item{graph}{An igraph object for the target dataset.}

\item{source_effects}{A named list of data frames with KO effects from source datasets.}

\item{pname}{The name of the hub node (e.g., "PC1").}

\item{pgenes}{A character vector of the signature genes.}

\item{ncores}{The number of cores for parallel computation.}
}
\value{
A list containing `B_matrix` and `portability_models`.
  `portability_models` contains a model for each combination of sources,
  plus a `mean_fallback` value.
}
\description{
Trains a GRN model and a set of hierarchically inclusive portability models
for all combinations of source datasets.
}
